---
title: "Analytic Hierarchy Process (AHP) applied into a indicators model of human factors resilience: the oil and gas industry case"
author: "Viviane Schneider"
date: "Start: 10/02/2020. Last version: 10/02/2020 - V.1"
output: 
  html_document: 
    highlight: zenburn
    keep_md: yes
    number_sections: yes
    theme: cerulean
    toc: yes
---


# Analytic Hierarchy Process (AHP)

Em desenvolvimento
## Domain Background  

Em desenvolvimento
## Study goals

**Main Goal:** 

Em desenvolvimento

## Methods and materials

Em desenvolvimento


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)

```

# Libraries

```{r libraries, cache=TRUE, include=FALSE}

library(dplyr)
library(plotly)
library(ggplot2)
library(tidyr)
library(magrittr)
library(plotrix)
library(rgl)
library(car)
library(lubridate)
library(ggplot2)
library(GGally)
library(corrplot)
library(corrgram)
library(ppcor)
library(tidyverse)

```

## Normalization

Scale: 1 - 6,being 1 a week point, 5 a strong point, and 6 means not responded

## Variables

### CONFORT AND LEISURE ON NON-WORKING SHIFTS (ConfLeis)

* ON PLATFORM (CONFORT AND LEISURE ON NON-WORKING SHIFTS):   
* ConfLeisWC: From West Carina
* ConfleisPL: From Pioneiro Libra

**Coluns:** VAR00022 until VAR00032.

**Scale:** Never: 0.4 
           Rarely: 0.6 
           Sometimes: 0.8 
           Almost always: 1.2 
           Always: 2 
           NR:0

**Questionary location image**
![](ConfLeis.JPG)

## Getting Data

```{r}

setwd("~/Analytic Hierarchy Process")

PioneiroLibra <- read_delim("PioneiroLibra.csv", ";", escape_double = FALSE, trim_ws = TRUE)

WestCarina <- read_delim("~/Analytic Hierarchy Process/WestCarina.csv", ";", escape_double = FALSE, trim_ws = TRUE)

# Function
# Transform vector into a data frame with frequency of levels and proportion
.Unianalysis = function (x) {
    y <- as.data.frame(as.table(table(x)))
    y <- arrange(y, desc(y$x))
    y <- mutate(y, Value = prop.table(y$Freq) * 10)
       return(y)
}

.Calc_conv = function(x) {
               y <- transform(x, Scale = c(2, 0.8, 1.2, 0.4, 0.6))
               y <- mutate(y, Result = Value * Scale)
               return(y)   
}
            
dimWC <- dim(WestCarina)
dimPL <- dim(PioneiroLibra)

#West Carina
glimpse(WestCarina)
glimpse(PioneiroLibra)

```

## Select variables of WC and PL from ConfLeis 

```{r explore}

## Select variables of WC and PL
ConfLeisWC <-
        WestCarina %>% 
        dplyr::select(VAR00005:VAR00006, VAR00022:VAR00028)
ConfLeisPL <-
        PioneiroLibra %>% 
        dplyr::select(VAR00005:VAR00006, VAR00022:VAR00028)


```

## Put together WC and PL 

```{r}

# Put together WC and PL
Two_Platform <- rbind.data.frame(ConfLeisWC, ConfLeisPL)

#Put variable names
names(Two_Platform) <- c("CIA","Genre","Privacy", "Talk_t_colleagues", "Play_instrument",  "Read_book", "Watch_TV","Gim","O_activity")

dim(Two_Platform)

```

## Analisy and tabulate each column

```{r}

#Analisy each column
ConfLeis_Explo <- apply(Two_Platform,2,.Unianalysis)
dim(ConfLeis_Explo)


```

## Scale Calculation

```{r}

#Calculation of scale
Privacy <-  .Calc_conv(ConfLeis_Explo[["Privacy"]])
Play_instrument <-  .Calc_conv(ConfLeis_Explo$Play_instrument)
Read_book <-  .Calc_conv(ConfLeis_Explo$Read_book)
Gim <-  .Calc_conv(ConfLeis_Explo$Gim)
O_activity <-  .Calc_conv(ConfLeis_Explo$O_activity)

Privacy
Play_instrument
Read_book
Gim
O_activity



```

## Final Score of ConfLeis

```{r}

# Final Score

FSP <- 5 - mean(Privacy$Result)
FSP
FSPI <- 5 - mean(Play_instrument$Result)
FSPI
FSRB <- 5 - mean(Read_book$Result)
FSRB
FSG <- 5 - mean(Gim$Result)
FSG



Final_Score <- mean(FSP, FSPI,FSRB,FSG)
Final_Score 


```



# Referências

CUANDRAS, C. M. NUEVOS MÉTODOS DE AN£LISIS MULTIVARIANTE. Propriedadade c.M. Cuadras
CMC Editions. Agramunt, 16, 08023 Barcelona, Spain: Revisado 21 de Junio de 2019. Disponível em http://www.ub.edu/stat/personal/cuadras/metodos.pdf


VICINI, L. Análise multivariada da teoria à prática / Lorena Vicini; orientador Adriano Mendonça Souza. - Santa Maria : UFSM, CCNE, 2005. 215 p. : il. 
